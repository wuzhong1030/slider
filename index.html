<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Document</title>
    <style>
    * {
        padding: 0;
        margin: 0;
    }
    
    body {
       height: 100%;
        background: #333;
        overflow: hidden;
    }
    
    #canvas {
        height: 100%;
        width: 100%;
        overflow: hidden;
    }
    
    ul,
    li {
        list-style: none;
        overflow: hidden;
        height: 100%;
    }
    
    li {
        /* display: table-cell;
    	vertical-align: middle; */
    	position: absolute;
        display: -webkit-box;
        -webkit-box-pack: center;
        -webkit-box-align: center;
    }
    
    li img {
        max-width: 100%;
        min-width: 100%;
    }
    </style>
</head>

<body>
    <div id="canvas"></div>
    <script>
    var list = [{
        height: 252,
        width: 500,
        path: '1.jpg'
    }, {
        height: 800,
        width: 1280,
        path: '2.jpg'
    }, {
        height: 391,
        width: 220,
        path: '3.jpg'
    }, {
        height: 610,
        width: 343,
        path: '4.gif'
    }, {
        height: 419,
        width: 670,
        path: '5.jpg'
    }, {
        height: 360,
        width: 640,
        path: '6.jpg'
    }, {
        height: 568,
        width: 305,
        path: '7.jpg'
    }];

    function Slide(opts) {
        this.wrap = opts.dom;
        this.list = opts.list;

        this.init();
        this.renderDOM();
        this.bindDOM();
    }

    Slide.prototype.init = function() {
        this.radio = window.innerHeight / window.innerWidth;
        this.scaleW = window.innerWidth;
        this.index = 0;
    };
    Slide.prototype.renderDOM = function() {
        var wrap = this.wrap,
            data = this.list,
            len = data.length;
        this.outer = document.createElement('ul');

        for (var i = 0; i < len; i++) {
            var item = data[i],
                li = document.createElement('li');
            li.style.width = window.innerWidth + 'px';
            li.style.webkitTransform = 'translate3d(' + i * this.scaleW + 'px, 0, 0)';
            if (item) {
                if (item.height / item.width > this.radio) {
                    li.innerHTML = '<img height="' + window.innerHeight + '" src="' + item.path + '">';
                } else {
                    li.innerHTML = '<img width="' + window.innerWidth + '" src="' + item.path + '">';
                }
            }
            this.outer.appendChild(li);
        }
        this.outer.style.cssText = 'width: ' + this.scaleW + 'px';
        wrap.style.height = window.innerHeight + 'px';
        wrap.appendChild(this.outer);
    }
    Slide.prototype.goIndex = function(n) {
        var index = this.index,
            lis = this.outer.getElementsByTagName("li"),
            len = list.length,
            cidx;

        if (typeof n == "number") {
            cidx = index;
        } else if (typeof n == "string") {
            cidx = index + n * 1;
        }

        if (cidx > len - 1) {
            cidx = len - 1;
        } else if (cidx < 0) {
            cidx = 0;
        }

        this.index = cidx;
        lis[cidx].style.webkitTransition = '-webkit-transform 0.2s ease-out';
        lis[cidx - 1] && (lis[cidx - 1].style.webkitTransition = '-webkit-transform 0.2s ease-out');
        lis[cidx + 1] && (lis[cidx + 1].style.webkitTransition = '-webkit-transform 0.2s ease-out');

        lis[cidx].style.webkitTransform = 'translate3d(0,0,0)';
        lis[cidx - 1] && (lis[cidx - 1].style.webkitTransform = 'translate3d(-' + this.scaleW + 'px,0,0)');
        lis[cidx + 1] && (lis[cidx + 1].style.webkitTransform = 'translate3d(' + this.scaleW + 'px,0,0)');

    }
    Slide.prototype.bindDOM = function() {
        var self = this,
            outer = self.outer,
            len = self.list.legth,
            scaleW = self.scaleW;

        var startHandler = function(evt) {
            self.startTime = new Date() * 1;
            self.startX = evt.touches[0].pageX;
            self.offset = 0;

            var target = evt.target;
            while (target.nodeName != "LI" && target.nodeName != "BODY") {
                target = target.parentNode;
            }
            self.target = target;
        }
        var moveHandler = function(evt) {
            evt.preventDefault();
            self.offsetX = evt.targetTouches[0].pageX - self.startX;
            var lis = outer.getElementsByTagName('li');
            var i = self.index - 1;
            var m = i + 3;
            for (i; i < m; i++) {
                console.log(lis[i]);
                lis[i] && (lis[i].style.webkitTransition = '-webkit-transform 0s ease-out');
                lis[i] && (lis[i].style.webkitTransform = 'translate3d(' + ((i - self.index) * self.scaleW + self.offsetX) + 'px, 0, 0)')
            }
        }
        var endHandler = function(evt) {
            evt.preventDefault();
            var boundary = scaleW / 6,
                endTime = new Date() * 1,
                lis = outer.getElementsByTagName('li');

            if (endTime - self.startTime > 300) {
                if (self.offsetX >= boundary) {
                    self.goIndex("-1")
                } else if (self.offsetX < 0 && self.offsetX < -boundary) {
                    self.goIndex("+1");
                } else {
                    self.goIndex("0");
                }
            } else {
                if (self.offsetX > 50) {
                    self.goIndex("-1")
                } else if (self.offsetX < -50) {
                    self.goIndex("+1");
                } else {
                    self.goIndex("0");
                }
            }
        }
        outer.addEventListener('touchstart', startHandler);
        outer.addEventListener('touchmove', moveHandler);
        outer.addEventListener('touchend', endHandler);
    }

    new Slide({
        'dom': document.getElementById('canvas'),
        'list': list
    })
    </script>
</body>

</html>
